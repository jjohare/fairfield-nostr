import{q as F,s as we,d,i as E,l as a,m as ke,g as I,c as k,e as y,j as P,h as b,k as O,p as be,n as V,u as ve,b as h,r as H,C as N,o as x,D as S,f as K,t as R,Z as ye,_ as Ce,$ as Ee,a0 as Ae,a as Me,A as z}from"../chunks/D9KvLAFu.js";import{S as We,i as Ie,a as ee,t as te,e as Pe,g as Be}from"../chunks/Bq9qkgAl.js";import{p as Le}from"../chunks/DbRkQB3_.js";import{d as Te,w as U,b as W}from"../chunks/BJIrN7iM.js";import{a as xe,i as Ne,b as Se}from"../chunks/Wg5dSDil.js";const je=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,De=!0,qe=!1,nt=Object.freeze(Object.defineProperty({__proto__:null,prerender:De,ssr:qe},Symbol.toStringTag,{value:"Module"})),Y=U(null),ge=U(!1),Z=U(typeof navigator<"u"?navigator.onLine:!0),X=U(null),J=U(!1),se=U(0);function ze(){typeof window>"u"||(window.addEventListener("online",()=>{Z.set(!0),_e()}),window.addEventListener("offline",()=>{Z.set(!1)}),window.addEventListener("beforeinstallprompt",n=>{n.preventDefault(),Y.set(n)}),window.addEventListener("appinstalled",()=>{J.set(!0),Y.set(null)}),window.matchMedia("(display-mode: standalone)").matches&&J.set(!0),navigator.serviceWorker?.addEventListener("message",n=>{const{type:e,count:t}=n.data;e==="SYNC_COMPLETE"&&(console.log(`[PWA] Background sync completed: ${t} messages`),se.set(0))}))}async function Ue(){const n=F(Y);if(!n)return console.warn("[PWA] Install prompt not available"),!1;try{await n.prompt();const{outcome:e}=await n.userChoice;return e==="accepted"?(J.set(!0),Y.set(null),!0):!1}catch(e){return console.error("[PWA] Install prompt failed:",e),!1}}async function Oe(){if(typeof navigator>"u"||!("serviceWorker"in navigator))return console.warn("[PWA] Service workers not supported"),null;try{const n=`${W}/service-worker.js`,e=`${W}/`,t=await navigator.serviceWorker.register(n,{scope:e});return console.log("[PWA] Service worker registered:",t),X.set(t),t.addEventListener("updatefound",()=>{const s=t.installing;s&&s.addEventListener("statechange",()=>{s.state==="installed"&&navigator.serviceWorker.controller&&ge.set(!0)})}),t}catch(n){return console.error("[PWA] Service worker registration failed:",n),null}}async function Ve(){const n=F(X);if(!n?.waiting){console.warn("[PWA] No waiting service worker");return}n.waiting.postMessage({type:"SKIP_WAITING"}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()})}async function He(){const n=F(X);return n?.active?new Promise((e,t)=>{const s=new MessageChannel;s.port1.onmessage=r=>{r.data.messages?(se.set(r.data.messages.length),e(r.data.messages)):t(new Error(r.data.error))},n.active.postMessage({type:"GET_QUEUE"},[s.port2])}):[]}async function _e(){const n=F(X);if(!n||!("sync"in n)){console.warn("[PWA] Background sync not supported");return}try{await n.sync.register("sync-messages"),console.log("[PWA] Background sync registered")}catch(e){console.error("[PWA] Background sync failed:",e)}}const Ye=Te([Y,J],([n,e])=>n!==null&&!e);async function Fe(){if(typeof window>"u")return;if(ze(),await Oe()){console.log("[PWA] Service worker registered successfully");try{const e=await He();e.length>0&&(console.log(`[PWA] Found ${e.length} queued messages`),F(Z)&&await _e())}catch(e){console.error("[PWA] Failed to check message queue:",e)}}}const{document:ue}=je;function ce(n){let e,t,s,r,l,o="Install Minimoomaa Noir for offline access",i,c,f,v="Install",p,m,_="Dismiss",A,u;return{c(){e=b("div"),t=S("svg"),s=S("path"),r=P(),l=b("span"),l.textContent=o,i=P(),c=b("div"),f=b("button"),f.textContent=v,p=P(),m=b("button"),m.textContent=_,this.h()},l(g){e=k(g,"DIV",{class:!0});var w=y(e);t=N(w,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var D=y(t);s=N(D,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(s).forEach(d),D.forEach(d),r=I(w),l=k(w,"SPAN",{"data-svelte-h":!0}),x(l)!=="svelte-16jwf1w"&&(l.textContent=o),i=I(w),c=k(w,"DIV",{class:!0});var B=y(c);f=k(B,"BUTTON",{class:!0,"data-svelte-h":!0}),x(f)!=="svelte-1tlyd0p"&&(f.textContent=v),p=I(B),m=k(B,"BUTTON",{class:!0,"data-svelte-h":!0}),x(m)!=="svelte-1qyf3o7"&&(m.textContent=_),B.forEach(d),w.forEach(d),this.h()},h(){a(s,"stroke-linecap","round"),a(s,"stroke-linejoin","round"),a(s,"stroke-width","2"),a(s,"d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),a(t,"xmlns","http://www.w3.org/2000/svg"),a(t,"fill","none"),a(t,"viewBox","0 0 24 24"),a(t,"class","stroke-current shrink-0 w-6 h-6"),a(f,"class","btn btn-sm btn-primary"),a(m,"class","btn btn-sm btn-ghost"),a(c,"class","flex gap-2"),a(e,"class","alert alert-info fixed top-0 left-0 right-0 z-50 rounded-none")},m(g,w){E(g,e,w),h(e,t),h(t,s),h(e,r),h(e,l),h(e,i),h(e,c),h(c,f),h(c,p),h(c,m),A||(u=[H(f,"click",n[12]),H(m,"click",n[11])],A=!0)},p:V,d(g){g&&d(e),A=!1,ve(u)}}}function fe(n){let e,t,s,r,l,o="A new version is available",i,c,f="Update Now",v,p;return{c(){e=b("div"),t=S("svg"),s=S("path"),r=P(),l=b("span"),l.textContent=o,i=P(),c=b("button"),c.textContent=f,this.h()},l(m){e=k(m,"DIV",{class:!0});var _=y(e);t=N(_,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var A=y(t);s=N(A,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(s).forEach(d),A.forEach(d),r=I(_),l=k(_,"SPAN",{"data-svelte-h":!0}),x(l)!=="svelte-1sypjsy"&&(l.textContent=o),i=I(_),c=k(_,"BUTTON",{class:!0,"data-svelte-h":!0}),x(c)!=="svelte-1vor793"&&(c.textContent=f),_.forEach(d),this.h()},h(){a(s,"stroke-linecap","round"),a(s,"stroke-linejoin","round"),a(s,"stroke-width","2"),a(s,"d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"),a(t,"xmlns","http://www.w3.org/2000/svg"),a(t,"fill","none"),a(t,"viewBox","0 0 24 24"),a(t,"class","stroke-current shrink-0 w-6 h-6"),a(c,"class","btn btn-sm btn-warning"),a(e,"class","alert alert-warning fixed top-0 left-0 right-0 z-50 rounded-none")},m(m,_){E(m,e,_),h(e,t),h(t,s),h(e,r),h(e,l),h(e,i),h(e,c),v||(p=H(c,"click",n[13]),v=!0)},p:V,d(m){m&&d(e),v=!1,p()}}}function de(n){let e,t,s,r,l,o,i=n[7]>0&&he(n);return{c(){e=b("div"),t=S("svg"),s=S("path"),r=P(),l=b("span"),o=R(`You're offline. Messages will be queued.
			`),i&&i.c(),this.h()},l(c){e=k(c,"DIV",{class:!0});var f=y(e);t=N(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var v=y(t);s=N(v,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(s).forEach(d),v.forEach(d),r=I(f),l=k(f,"SPAN",{});var p=y(l);o=K(p,`You're offline. Messages will be queued.
			`),i&&i.l(p),p.forEach(d),f.forEach(d),this.h()},h(){a(s,"stroke-linecap","round"),a(s,"stroke-linejoin","round"),a(s,"stroke-width","2"),a(s,"d","M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"),a(t,"xmlns","http://www.w3.org/2000/svg"),a(t,"fill","none"),a(t,"viewBox","0 0 24 24"),a(t,"class","stroke-current shrink-0 w-6 h-6"),a(e,"class","alert alert-error fixed bottom-0 left-0 right-0 z-50 rounded-none")},m(c,f){E(c,e,f),h(e,t),h(t,s),h(e,r),h(e,l),h(l,o),i&&i.m(l,null)},p(c,f){c[7]>0?i?i.p(c,f):(i=he(c),i.c(),i.m(l,null)):i&&(i.d(1),i=null)},d(c){c&&d(e),i&&i.d()}}}function he(n){let e,t,s;return{c(){e=R("("),t=R(n[7]),s=R(" queued)")},l(r){e=K(r,"("),t=K(r,n[7]),s=K(r," queued)")},m(r,l){E(r,e,l),E(r,t,l),E(r,s,l)},p(r,l){l&128&&Me(t,r[7])},d(r){r&&(d(e),d(t),d(s))}}}function Ge(n){let e,t='<div class="loading loading-spinner loading-lg text-primary"></div>';return{c(){e=b("div"),e.innerHTML=t,this.h()},l(s){e=k(s,"DIV",{class:!0,"data-svelte-h":!0}),x(e)!=="svelte-1ogc7xv"&&(e.innerHTML=t),this.h()},h(){a(e,"class","flex items-center justify-center min-h-screen")},m(s,r){E(s,e,r)},p:V,i:V,o:V,d(s){s&&d(e)}}}function Qe(n){let e,t,s=n[5]&&n[8]&&pe(n);const r=n[15].default,l=ye(r,n,n[14],null);return{c(){s&&s.c(),e=P(),l&&l.c()},l(o){s&&s.l(o),e=I(o),l&&l.l(o)},m(o,i){s&&s.m(o,i),E(o,e,i),l&&l.m(o,i),t=!0},p(o,i){o[5]&&o[8]?s?s.p(o,i):(s=pe(o),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),l&&l.p&&(!t||i&16384)&&Ce(l,r,o,o[14],t?Ae(r,o[14],i,null):Ee(o[14]),null)},i(o){t||(te(l,o),t=!0)},o(o){ee(l,o),t=!1},d(o){o&&d(e),s&&s.d(o),l&&l.d(o)}}}function pe(n){let e,t,s=`<a href="${W}/chat" class="btn btn-ghost text-xl">Minimoomaa Noir</a>`,r,l,o,i,c,f="Channels",v,p,m,_="Messages",A,u,g,w,D,B,C="Logout",$,ne,M=n[9]&&me(n);function re(L,T){return L[2]==="dark"?Re:Ke}let G=re(n),j=G(n);return{c(){e=b("nav"),t=b("div"),t.innerHTML=s,r=P(),l=b("div"),o=b("ul"),i=b("li"),c=b("a"),c.textContent=f,v=P(),p=b("li"),m=b("a"),m.textContent=_,A=P(),M&&M.c(),u=P(),g=b("div"),w=b("button"),j.c(),D=P(),B=b("button"),B.textContent=C,this.h()},l(L){e=k(L,"NAV",{class:!0});var T=y(e);t=k(T,"DIV",{class:!0,"data-svelte-h":!0}),x(t)!=="svelte-gdh5eg"&&(t.innerHTML=s),r=I(T),l=k(T,"DIV",{class:!0});var le=y(l);o=k(le,"UL",{class:!0});var q=y(o);i=k(q,"LI",{});var oe=y(i);c=k(oe,"A",{href:!0,"data-svelte-h":!0}),x(c)!=="svelte-1jb66cd"&&(c.textContent=f),oe.forEach(d),v=I(q),p=k(q,"LI",{});var ae=y(p);m=k(ae,"A",{href:!0,"data-svelte-h":!0}),x(m)!=="svelte-cztui3"&&(m.textContent=_),ae.forEach(d),A=I(q),M&&M.l(q),q.forEach(d),le.forEach(d),u=I(T),g=k(T,"DIV",{class:!0});var Q=y(g);w=k(Q,"BUTTON",{class:!0});var ie=y(w);j.l(ie),ie.forEach(d),D=I(Q),B=k(Q,"BUTTON",{class:!0,"data-svelte-h":!0}),x(B)!=="svelte-1ppmxs8"&&(B.textContent=C),Q.forEach(d),T.forEach(d),this.h()},h(){a(t,"class","navbar-start"),a(c,"href",W+"/chat"),z(c,"active",n[0].url.pathname.startsWith(`${W}/chat`)),a(m,"href",W+"/dm"),z(m,"active",n[0].url.pathname.startsWith(`${W}/dm`)),a(o,"class","menu menu-horizontal px-1"),a(l,"class","navbar-center hidden lg:flex"),a(w,"class","btn btn-ghost btn-circle"),a(B,"class","btn btn-ghost"),a(g,"class","navbar-end gap-2"),a(e,"class","navbar bg-base-200 shadow-lg")},m(L,T){E(L,e,T),h(e,t),h(e,r),h(e,l),h(l,o),h(o,i),h(i,c),h(o,v),h(o,p),h(p,m),h(o,A),M&&M.m(o,null),h(e,u),h(e,g),h(g,w),j.m(w,null),h(g,D),h(g,B),$||(ne=[H(w,"click",n[10]),H(B,"click",n[16])],$=!0)},p(L,T){T&1&&z(c,"active",L[0].url.pathname.startsWith(`${W}/chat`)),T&1&&z(m,"active",L[0].url.pathname.startsWith(`${W}/dm`)),L[9]?M?M.p(L,T):(M=me(L),M.c(),M.m(o,null)):M&&(M.d(1),M=null),G!==(G=re(L))&&(j.d(1),j=G(L),j&&(j.c(),j.m(w,null)))},d(L){L&&d(e),M&&M.d(),j.d(),$=!1,ve(ne)}}}function me(n){let e,t,s="Admin";return{c(){e=b("li"),t=b("a"),t.textContent=s,this.h()},l(r){e=k(r,"LI",{});var l=y(e);t=k(l,"A",{href:!0,"data-svelte-h":!0}),x(t)!=="svelte-dtigh"&&(t.textContent=s),l.forEach(d),this.h()},h(){a(t,"href",W+"/admin"),z(t,"active",n[0].url.pathname===`${W}/admin`)},m(r,l){E(r,e,l),h(e,t)},p(r,l){l&1&&z(t,"active",r[0].url.pathname===`${W}/admin`)},d(r){r&&d(e)}}}function Ke(n){let e,t;return{c(){e=S("svg"),t=S("path"),this.h()},l(s){e=N(s,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var r=y(e);t=N(r,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(t).forEach(d),r.forEach(d),this.h()},h(){a(t,"stroke","currentColor"),a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"stroke-width","2"),a(t,"d","M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"class","w-5 h-5")},m(s,r){E(s,e,r),h(e,t)},d(s){s&&d(e)}}}function Re(n){let e,t;return{c(){e=S("svg"),t=S("path"),this.h()},l(s){e=N(s,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var r=y(e);t=N(r,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(t).forEach(d),r.forEach(d),this.h()},h(){a(t,"stroke","currentColor"),a(t,"stroke-linecap","round"),a(t,"stroke-linejoin","round"),a(t,"stroke-width","2"),a(t,"d","M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"fill","none"),a(e,"viewBox","0 0 24 24"),a(e,"class","w-5 h-5")},m(s,r){E(s,e,r),h(e,t)},d(s){s&&d(e)}}}function Ze(n){let e,t,s,r,l,o,i,c,f=n[3]&&ce(n),v=n[4]&&fe(n),p=!n[6]&&de(n);const m=[Qe,Ge],_=[];function A(u,g){return u[1]?0:1}return o=A(n),i=_[o]=m[o](n),{c(){e=P(),f&&f.c(),t=P(),v&&v.c(),s=P(),p&&p.c(),r=P(),l=b("div"),i.c(),this.h()},l(u){ke("svelte-1n07fap",ue.head).forEach(d),e=I(u),f&&f.l(u),t=I(u),v&&v.l(u),s=I(u),p&&p.l(u),r=I(u),l=k(u,"DIV",{class:!0});var w=y(l);i.l(w),w.forEach(d),this.h()},h(){ue.title="Minimoomaa Noir",a(l,"class","min-h-screen w-full transition-base")},m(u,g){E(u,e,g),f&&f.m(u,g),E(u,t,g),v&&v.m(u,g),E(u,s,g),p&&p.m(u,g),E(u,r,g),E(u,l,g),_[o].m(l,null),c=!0},p(u,[g]){u[3]?f?f.p(u,g):(f=ce(u),f.c(),f.m(t.parentNode,t)):f&&(f.d(1),f=null),u[4]?v?v.p(u,g):(v=fe(u),v.c(),v.m(s.parentNode,s)):v&&(v.d(1),v=null),u[6]?p&&(p.d(1),p=null):p?p.p(u,g):(p=de(u),p.c(),p.m(r.parentNode,r));let w=o;o=A(u),o===w?_[o].p(u,g):(Be(),ee(_[w],1,1,()=>{_[w]=null}),Pe(),i=_[o],i?i.p(u,g):(i=_[o]=m[o](u),i.c()),te(i,1),i.m(l,null))},i(u){c||(te(i),c=!0)},o(u){ee(i),c=!1},d(u){u&&(d(e),d(t),d(s),d(r),d(l)),f&&f.d(u),v&&v.d(u),p&&p.d(u),_[o].d()}}}function Je(n,e,t){let s,r,l,o,i,c;O(n,Le,C=>t(0,r=C)),O(n,Z,C=>t(6,l=C)),O(n,se,C=>t(7,o=C)),O(n,Ne,C=>t(8,i=C)),O(n,Se,C=>t(9,c=C));let{$$slots:f={},$$scope:v}=e,p=!1,m="dark",_=!1,A=!1;Ye.subscribe(C=>{t(3,_=C)}),ge.subscribe(C=>{t(4,A=C)}),be(()=>{t(1,p=!0);{const C=localStorage.getItem("theme")||"dark";t(2,m=C),document.documentElement.setAttribute("data-theme",C),Fe()}});function u(){t(2,m=m==="dark"?"light":"dark"),document.documentElement.setAttribute("data-theme",m),localStorage.setItem("theme",m)}function g(){t(3,_=!1)}async function w(){await Ue()&&t(3,_=!1)}async function D(){await Ve()}const B=()=>xe.logout();return n.$$set=C=>{"$$scope"in C&&t(14,v=C.$$scope)},n.$$.update=()=>{n.$$.dirty&1&&t(5,s=r.url.pathname!==`${W}/`&&r.url.pathname!==W&&r.url.pathname!==`${W}/signup`&&r.url.pathname!==`${W}/setup`)},[r,p,m,_,A,s,l,o,i,c,u,g,w,D,v,f,B]}class rt extends We{constructor(e){super(),Ie(this,e,Je,Ze,we,{})}}export{rt as component,nt as universal};
//# sourceMappingURL=0.0YGDNZ2E.js.map
